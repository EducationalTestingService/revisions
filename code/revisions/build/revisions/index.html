<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.5">
<title>revisions API documentation</title>
<meta name="description" content="Revisions …">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source > summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible;min-width:max-content}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin:1em 0}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
/* Collapse source docstrings */
setTimeout(() => {
[...document.querySelectorAll('.hljs.language-python > .hljs-string')]
.filter(el => el.innerHTML.length > 200 && ['"""', "'''"].includes(el.innerHTML.substring(0, 3)))
.forEach(el => {
let d = document.createElement('details');
d.classList.add('hljs-string');
d.innerHTML = '<summary>"""</summary>' + el.innerHTML.substring(3);
el.replaceWith(d);
});
}, 100);
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Package <code>revisions</code></h1>
</header>
<section id="section-intro">
<h1 id="revisions">Revisions</h1>
<p>Revisions is a tool that finds the differences between two texts and then outputs a JSON file with the changes and their character indices, along with an HTML file displaying the changes. While there are several tools that accomplish this, few show reliable changes (insertions, deletions, and substitutions) at the word level for long texts. This package utilizes <a href="https://github.com/ghpaetzold/massalign">MassAlign</a> to link paragraphs and sentences, and then <a href="https://github.com/google/diff-match-patch">diff-match-patch</a> to find changes at the word-level.</p>
<h2 id="i-configuration-file">I. Configuration file</h2>
<p>A sample configuration file <code>sample_config.json</code> is provided.</p>
<p>What the fields mean:</p>
<ul>
<li><code>root</code> is the path to the cloned repository. <strong>This must be changed.</strong></li>
<li><code>stop_words</code> is the path to a text file with one stop word on each line. A default is provided in the repository.</li>
</ul>
<p>Make a copy of <code>sample_config.json</code> and make changes as needed. After this point, the documentation assumes that your copy of the configuration file is called <code>config.json</code>.</p>
<h2 id="ii-getting-revisions">II. Getting revisions</h2>
<p>Note: the scripts assume <em>utf-8 encoding</em> (the default in Python 3).
All text is run through <code><a title="revisions.utils.unicode_normalize" href="utils.html#revisions.utils.unicode_normalize">unicode_normalize()</a></code> to remove ASCII characters and normalize unicode characters. </p>
<p>Given two documents, the script will produce an HTML file and a JSON file.
The HTML displays the document versions side by side with the revisions highlighted, while the JSON contains revision offsets.</p>
<h3 id="compare-two-document-versions">Compare two document versions</h3>
<p>Given two text files where the text of version n is in <code>file1</code> and the text of version n+1 is in <code>file2</code>, produce the output files.</p>
<pre><code>python3 code/revisions/get_single_output.py --help
</code></pre>
<h3 id="parsing-the-json-file">Parsing the JSON file</h3>
<p>Printing the aligned sentences and their revisions:</p>
<pre><code class="language-python">import json

with open(path/to/json) as infile:
   edits_json = json.load(infile)

for s1_index, alignment_dict in edits_json[&quot;alignments&quot;]:
   s1 = edits_json[&quot;file1_sentences&quot;][s1_index][&quot;text&quot;]
   s2 = [edits_json[&quot;file2_sentences&quot;][s2_index] for s2_index in alignment_dict[&quot;match&quot;]]

   print(s1)
   print(s2)
   print(alignment_dict[&quot;edits&quot;])
   print(&quot;&quot;)
</code></pre>
<h2 id="iv-tests">IV. Tests</h2>
<pre><code>cd code/revisions/tests
pytest
</code></pre>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="revisions.aligned_text" href="aligned_text.html">revisions.aligned_text</a></code></dt>
<dd>
<div class="desc"><p><code>AlignedText</code> aligns the paragraphs and sentences given two text files and
stores the alignments along with sentence offsets.</p></div>
</dd>
<dt><code class="name"><a title="revisions.diff" href="diff.html">revisions.diff</a></code></dt>
<dd>
<div class="desc"><p>Detect diffs on the word level, based on
<a href="https://github.com/google/diff-match-patch/wiki/Line-or-Word-Diffs">https://github.com/google/diff-match-patch/wiki/Line-or-Word-Diffs</a> …</p></div>
</dd>
<dt><code class="name"><a title="revisions.edits_html" href="edits_html.html">revisions.edits_html</a></code></dt>
<dd>
<div class="desc"><p><code>EditsHtml</code> identifies and formats substitutions, deletions, and insertions.
Stores the contents of the HTML output in <code>EditsHtml.html1</code> and …</p></div>
</dd>
<dt><code class="name"><a title="revisions.get_single_output" href="get_single_output.html">revisions.get_single_output</a></code></dt>
<dd>
<div class="desc"><p>Given two text files, align and create an HTML and a JSON file
with information about sentence alignments and revisions.</p></div>
</dd>
<dt><code class="name"><a title="revisions.tests" href="tests/index.html">revisions.tests</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="revisions.utils" href="utils.html">revisions.utils</a></code></dt>
<dd>
<div class="desc"><p>Utilities for (1) reading and writing pickles,
(2) reading and writing JSON, (3) tokenizing,
(4) applying a function to a DataFrame with …</p></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul>
<li><a href="#revisions">Revisions</a><ul>
<li><a href="#i-configuration-file">I. Configuration file</a></li>
<li><a href="#ii-getting-revisions">II. Getting revisions</a><ul>
<li><a href="#compare-two-document-versions">Compare two document versions</a></li>
<li><a href="#parsing-the-json-file">Parsing the JSON file</a></li>
</ul>
</li>
<li><a href="#iv-tests">IV. Tests</a></li>
</ul>
</li>
</ul>
</div>
<ul id="index">
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="revisions.aligned_text" href="aligned_text.html">revisions.aligned_text</a></code></li>
<li><code><a title="revisions.diff" href="diff.html">revisions.diff</a></code></li>
<li><code><a title="revisions.edits_html" href="edits_html.html">revisions.edits_html</a></code></li>
<li><code><a title="revisions.get_single_output" href="get_single_output.html">revisions.get_single_output</a></code></li>
<li><code><a title="revisions.tests" href="tests/index.html">revisions.tests</a></code></li>
<li><code><a title="revisions.utils" href="utils.html">revisions.utils</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.5</a>.</p>
</footer>
</body>
</html>
